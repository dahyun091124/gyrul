import streamlit as st
import os

# ì´ íŒŒì¼ì€ ë©˜í†  ì „ìš© í˜ì´ì§€ì…ë‹ˆë‹¤. ì—­í• ì€ 'mentor'ë¡œ ê³ ì •ë©ë‹ˆë‹¤.
ROLE = 'mentor'

# í˜ì´ì§€ ìƒíƒœ ê´€ë¦¬ (í•„ìš”í•œ ê²½ìš°)
if 'page' not in st.session_state:
    st.session_state.page = 'signup_and_survey'
if 'survey_done' not in st.session_state:
    st.session_state.survey_done = False
if 'avatar_file' not in st.session_state:
    # 40ëŒ€ ì´ìƒ ì•„ë°”íƒ€ 4ê°œ ì¤‘ ê¸°ë³¸ê°’ ì„¤ì •
    st.session_state.avatar_file = 'KakaoTalk_Photo_2025-10-13-15-19-00.png' 

# ì•„ë°”íƒ€ ëª©ë¡ (40ëŒ€ ì´ìƒìœ¼ë¡œ ë³´ì´ëŠ” ì´ë¯¸ì§€ 4ê°œë§Œ ì‚¬ìš©)
# íŒŒì¼ ì´ë¦„ì€ ì½”ë“œë¥¼ ê¹”ë”í•˜ê²Œ í•˜ê¸° ìœ„í•´ ë³„ë„ì˜ ë”•ì…”ë„ˆë¦¬ë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤.
AVATAR_FILES = {
    "ğŸ‘µ ì§€í˜œë¡œìš´ ë©˜í†  (ì—¬)": "KakaoTalk_Photo_2025-10-13-15-19-08.png", 
    "ğŸ‘´ ì¸ìí•œ ë©˜í†  (ë‚¨)": "KakaoTalk_Photo_2025-10-13-15-19-00.png", 
    "ğŸ§‘â€ğŸ« ì»¤ë¦¬ì–´ ë©˜í†  (ë‚¨)": "KakaoTalk_Photo_2025-10-13-15-19-15.png", # ì…”ì¸ , ë„¥íƒ€ì´ ë³µì¥ìœ¼ë¡œ ì „ë¬¸ì ì¸ ì´ë¯¸ì§€
}

# ì‚¬ìš©ì ì¹œí™”ì ì¸ CSS (ê¸€ì”¨ë¥¼ ìµœëŒ€í•œ í¬ê²Œ)
st.markdown("""
<style>
    /* ... (ì´ì „ê³¼ ë™ì¼í•œ CSS ìŠ¤íƒ€ì¼ ìœ ì§€) ... */
    /* ì „ì²´ í°íŠ¸ í¬ê¸° ë° ìƒ‰ìƒ */
    .st-emotion-cache-183060u, .st-emotion-cache-1cyp687, .st-emotion-cache-16sx4w0, .st-emotion-cache-11r9c4z, .st-emotion-cache-19k721u {
        font-size: 1.4rem !important;
        color: #e0e0e0 !important;
    }
    
    /* ì œëª© */
    h1, h2, h3 {
        font-size: 2.5rem !important;
        color: #f7a300 !important;
        font-weight: bold;
    }
    h3 {
        font-size: 2rem !important;
    }
    
    /* ë²„íŠ¼ */
    .st-emotion-cache-19k721u, .st-emotion-cache-11r9c4z {
        font-size: 1.5rem !important;
        padding: 0.75rem 1.5rem;
    }
    
    /* ì•„ë°”íƒ€ ì´ë¯¸ì§€ í¬ê¸° ì¡°ì • */
    .avatar-container img {
        max-width: 150px;
        height: auto;
        border-radius: 10px;
        margin: 10px auto;
        display: block;
    }
</style>
""", unsafe_allow_html=True)

# í˜ì´ì§€ ì´ë™ í•¨ìˆ˜
def set_page(page_name):
    st.session_state.page = page_name

# ì‚¬ì´ë“œë°” ë©”ë‰´
with st.sidebar:
    st.image("https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png", width=50)
    st.title("ë©˜í†  ì „ìš© ë©”ë‰´")
    st.markdown("---")
    if st.button("ğŸ“ íšŒì›ê°€ì…/ì„¤ë¬¸"): set_page('signup_and_survey')
    if st.button("ğŸ‘¤ ë‚´ ë§¤ì¹­"): set_page('my_matches')
    if st.button("ğŸ” ë©˜í‹° ì°¾ê¸°"): set_page('find_matches')
    if st.button("âš™ï¸ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ"): set_page('admin_dashboard')
    st.markdown("---")
    st.info("â€» ë°ëª¨ìš©: ë¡œì»¬ì— ì €ì¥ë©ë‹ˆë‹¤.")


# --- ë©”ì¸ í˜ì´ì§€ ë¡œì§ ---

if st.session_state.page == 'signup_and_survey':
    st.title("âœ¨ ë©˜í†  íšŒì›ê°€ì… ë° ì„¤ë¬¸")
    st.markdown("ê²½í—˜ê³¼ ì§€í˜œë¥¼ ë‚˜ëˆ„ì–´ì¤„ **ë©˜í† ë‹˜**ì„ ëª¨ì‹­ë‹ˆë‹¤.")
    
    # ----------------------------------------------------------------------
    # 1. íšŒì›ê°€ì… í¼
    # ----------------------------------------------------------------------
    with st.form("signup_form", clear_on_submit=False):
        st.subheader("1. ì•„ë°”íƒ€ ë° ê³„ì • ì •ë³´")
        
        # ì•„ë°”íƒ€ ì„ íƒ
        selected_avatar_name = st.selectbox("í”„ë¡œí•„ ì•„ë°”íƒ€ ì„ íƒ", list(AVATAR_FILES.keys()))
        st.session_state.avatar_file = AVATAR_FILES[selected_avatar_name]
        
        # ì•„ë°”íƒ€ ì´ë¯¸ì§€ í‘œì‹œ
        st.markdown("<div class='avatar-container'>", unsafe_allow_html=True)
        try:
            # os.path.joinì„ ì‚¬ìš©í•˜ì—¬ í˜„ì¬ ë””ë ‰í† ë¦¬ì˜ íŒŒì¼ì„ ì°¸ì¡°
            st.image(os.path.join(".", st.session_state.avatar_file), caption=selected_avatar_name)
        except:
            st.warning(f"âš ï¸ ì•„ë°”íƒ€ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. GitHubì— '{st.session_state.avatar_file}' íŒŒì¼ì´ ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.")
        st.markdown("</div>", unsafe_allow_html=True)
        
        st.markdown("---")
        
        name = st.text_input("ì´ë¦„")
        email = st.text_input("ì´ë©”ì¼ (ë¡œê·¸ì¸ ID)")
        password = st.text_input("ë¹„ë°€ë²ˆí˜¸", type="password")
        confirm_password = st.text_input("ë¹„ë°€ë²ˆí˜¸ í™•ì¸", type="password")
        
        submitted = st.form_submit_button("íšŒì›ê°€ì…í•˜ê³  ì„¤ë¬¸í•˜ê¸°")
        if submitted:
            if not name or not email or not password:
                st.error("âŒ ëª¨ë“  ê³„ì • ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
            elif password != confirm_password:
                st.error("âŒ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.")
            else:
                st.success("âœ… íšŒì›ê°€ì… ì •ë³´ê°€ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤! ì•„ë˜ ì„¤ë¬¸ì„ ê³„ì† ì§„í–‰í•´ì£¼ì„¸ìš”.")
                st.session_state.survey_done = True
    
    st.markdown("---")
    
    # ----------------------------------------------------------------------
    # 2. ì„¤ë¬¸ì¡°ì‚¬ í¼ (ëª¨ë“  í•­ëª© í¬í•¨)
    # ----------------------------------------------------------------------
    if st.session_state.survey_done:
        st.header("2. ë©˜í†  í”„ë¡œí•„ ì„¤ë¬¸")
        st.write("ì„±ê³µì ì¸ ë§¤ì¹­ì„ ìœ„í•´ ì•„ë˜ í•­ëª©ì— ë‹µí•´ì£¼ì„¸ìš”.")
        
        # ë‚˜ë¨¸ì§€ ì„¤ë¬¸ í•­ëª©ì€ ì´ì „ê³¼ ë™ì¼í•˜ê²Œ ìœ ì§€ë©ë‹ˆë‹¤.
        with st.form("survey_form", clear_on_submit=True):
            st.subheader("â— ê¸°ë³¸ ì •ë³´")
            gender = st.radio("ì„±ë³„", ["ë‚¨", "ì—¬", "ê¸°íƒ€"], horizontal=True)
            age_group = st.selectbox(
                "ë‚˜ì´ëŒ€",
                ["ë§Œ 40ì„¸~49ì„¸", "ë§Œ 50ì„¸~59ì„¸", "ë§Œ 60ì„¸~69ì„¸", "ë§Œ 70ì„¸~79ì„¸", "ë§Œ 80ì„¸~89ì„¸", "ë§Œ 90ì„¸ ì´ìƒ"]
            )

            # --- ì§ì¢… ì„ íƒ ---
            st.subheader("â— í˜„ì¬ ì§ì¢…")
            occupation_options = [
                "ê²½ì˜ì (CEO, ì‚¬ì—…ì£¼ ë“±)", "í–‰ì •ê´€ë¦¬", "ì˜í•™/ë³´ê±´", "ë²•ë¥ /í–‰ì •", "êµìœ¡", "ì—°êµ¬ê°œë°œ/IT", 
                "ì˜ˆìˆ /ë””ìì¸", "ê¸°ìˆ /ê¸°ëŠ¥", "ì„œë¹„ìŠ¤ ì „ë¬¸", "ì¼ë°˜ ì‚¬ë¬´", "ì˜ì—… ì›", "íŒë§¤", "ì„œë¹„ìŠ¤", 
                "ì˜ë£Œ/ë³´ê±´ ì„œë¹„ìŠ¤", "ìƒì‚°/ì œì¡°", "ê±´ì„¤/ì‹œì„¤", "ë†ë¦¼ìˆ˜ì‚°ì—…", "ìš´ì†¡/ê¸°ê³„", "ìš´ì†¡ ê´€ë¦¬", 
                "ì²­ì†Œ/ê²½ë¹„", "ë‹¨ìˆœë…¸ë¬´", "í•™ìƒ", "ì „ì—…ì£¼ë¶€", "êµ¬ì§ì/í”„ë¦¬ëœì„œ(ì„ì‹œ)", "ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)"
            ]
            occupation = st.selectbox("í˜„ì¬ ì§ì¢…", occupation_options)

            # --- ê°€ì… ëª©ì  ë° ëŒ€í™” ì£¼ì œ ---
            st.subheader("â— ë©˜í† ë§ ëª©ì  ë° ì£¼ì œ")
            purpose = st.multiselect(
                "ë©˜í† ë§ì„ í†µí•´ ì–´ë–¤ ë„ì›€ì„ ì£¼ê³  ì‹¶ìœ¼ì‹ ê°€ìš”? (ë³µìˆ˜ì„ íƒ ê°€ëŠ¥)",
                ["ì§„ë¡œ/ì»¤ë¦¬ì–´ ì¡°ì–¸", "í•™ì—…/ì „ë¬¸ì§€ì‹ ì¡°ì–¸", "ì‚¬íšŒ/ì¸ìƒ ê²½í—˜ ê³µìœ ", "ì •ì„œì  ì§€ì§€ ë° ëŒ€í™”"]
            )
            topic = st.multiselect(
                "ë©˜í† ë§ì—ì„œ ì£¼ë¡œ ì–´ë–¤ ì£¼ì œì— ëŒ€í•´ ì´ì•¼ê¸°í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”?",
                ["ì§„ë¡œÂ·ì§ì—…", "í•™ì—…Â·ì „ë¬¸ ì§€ì‹", "ì¸ìƒ ê²½í—˜Â·ì‚¶ì˜ ê°€ì¹˜ê´€", "ëŒ€ì¤‘ë¬¸í™”Â·ì·¨ë¯¸", "ì‚¬íšŒ ë¬¸ì œÂ·ì‹œì‚¬", "ê±´ê°•Â·ì›°ë¹™"]
            )
            
            # --- ì†Œí†µ ìŠ¤íƒ€ì¼ ---
            st.subheader("â— ì„ í˜¸í•˜ëŠ” ì†Œí†µ ë°©ë²•")
            communication_method = st.radio("ë§Œë‚¨ ë°©ì‹", ["ëŒ€ë©´ ë§Œë‚¨", "í™”ìƒ ì±„íŒ…", "ì¼ë°˜ ì±„íŒ…"], horizontal=True)
            communication_day = st.multiselect("ì†Œí†µ ê°€ëŠ¥í•œ ìš”ì¼ (ë³µìˆ˜ì„ íƒ)", ["ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† ", "ì¼"])
            communication_time = st.multiselect("ì†Œí†µ ê°€ëŠ¥í•œ ì‹œê°„ëŒ€ (ë³µìˆ˜ì„ íƒ)", ["ì˜¤ì „", "ì˜¤í›„", "ì €ë…", "ë°¤"])
            
            st.subheader("â— ì†Œí†µ ìŠ¤íƒ€ì¼")
            communication_style = st.selectbox(
                "í‰ì†Œ ëŒ€í™” ì‹œ ë³¸ì¸ê³¼ ë¹„ìŠ·í•˜ë‹¤ê³  ìƒê°ë˜ëŠ” ê²ƒì„ ì„ íƒí•´ì£¼ì„¸ìš”.",
                [
                    "ì—°ë‘ë¶€í˜•: ì¡°ìš©í•˜ê³  ì°¨ë¶„í•˜ê²Œ, ìƒëŒ€ë°© ì–˜ê¸°ë¥¼ ê²½ì²­í•˜ë©° ê³µê°í•´ ì£¼ëŠ” í¸ì´ì—ìš”.", 
                    "ë¶„ìœ„ê¸°ë©”ì´ì»¤í˜•: í™œë°œí•˜ê³  ì—ë„ˆì§€ê°€ ë„˜ì³ ëŒ€í™”ë¥¼ ì´ëŒì–´ê°€ëŠ” í¸ì´ì—ìš”.",
                    "íš¨ìœ¨ì¶”êµ¬í˜•: ì£¼ì œë¥¼ ì²´ê³„ì ìœ¼ë¡œ ì •ë¦¬í•˜ê³  ëª©í‘œ ì§€í–¥ì ìœ¼ë¡œ ëŒ€í™”í•˜ëŠ” í¸ì´ì—ìš”.",
                    "ëŒëŒì´í˜•: ììœ ë¡­ê³  í¸ì•ˆí•˜ê²Œ, ì¦‰í¥ì ìœ¼ë¡œ ëŒ€í™”ë¥¼ ì´ì–´ê°€ëŠ” í¸ì´ì—ìš”.",
                    "ê°ì„± ì¶©ë§Œí˜•: ê°ì„±ì ì¸ ëŒ€í™”ë¥¼ ì¢‹ì•„í•˜ê³  ìœ„ë¡œì™€ ì§€ì§€ë¥¼ ì£¼ëŠ” í¸ì´ì—ìš”.",
                    "ëƒ‰ì² í•œ ì¡°ì–¸ìí˜•: ë…¼ë¦¬ì ì´ê³  ë¬¸ì œ í•´ê²° ì¤‘ì‹¬ìœ¼ë¡œ ì¡°ì–¸ì„ ì£¼ê³ ë°›ëŠ” í¸ì´ì—ìš”."
                ]
            )

            # --- ê´€ì‹¬ì‚¬ ë° ì·¨í–¥ ---
            st.subheader("â— ê´€ì‹¬ì‚¬, ì·¨í–¥")
            hobby = st.multiselect(
                "1) ì—¬ê°€/ì·¨ë¯¸ ê´€ë ¨",
                ["ë…ì„œ", "ìŒì•… ê°ìƒ", "ì˜í™”/ë“œë¼ë§ˆ ê°ìƒ", "ê²Œì„ (PC/ì½˜ì†”/ëª¨ë°”ì¼)", "ìš´ë™/ìŠ¤í¬ì¸  ê´€ëŒ", "ë¯¸ìˆ Â·ì „ì‹œ ê°ìƒ", "ì—¬í–‰", "ìš”ë¦¬/ë² ì´í‚¹", "ì‚¬ì§„/ì˜ìƒ ì œì‘", "ì¶¤/ë…¸ë˜"]
            )
            academic = st.multiselect(
                "2) í•™ë¬¸/ì§€ì  ê´€ì‹¬ì‚¬",
                ["ì¸ë¬¸í•™ (ì² í•™, ì—­ì‚¬, ë¬¸í•™ ë“±)", "ì‚¬íšŒê³¼í•™ (ì •ì¹˜, ê²½ì œ, ì‚¬íšŒ, ì‹¬ë¦¬ ë“±)", "ìì—°ê³¼í•™ (ë¬¼ë¦¬, í™”í•™, ìƒëª…ê³¼í•™ ë“±)", "ìˆ˜í•™/ë…¼ë¦¬ í¼ì¦", "IT/í…Œí¬ë†€ë¡œì§€ (AI, ì½”ë”©, ë¡œë´‡ ë“±)", "í™˜ê²½/ì§€ì†ê°€ëŠ¥ì„±"]
            )
            lifestyle = st.multiselect(
                "3) ë¼ì´í”„ìŠ¤íƒ€ì¼",
                ["íŒ¨ì…˜/ë·°í‹°", "ê±´ê°•/ì›°ë¹™", "ìê¸°ê³„ë°œ", "ì‚¬íšŒì°¸ì—¬/ë´‰ì‚¬í™œë™", "ì¬í…Œí¬/íˆ¬ì", "ë°˜ë ¤ë™ë¬¼"]
            )
            pop_culture = st.multiselect(
                "4) ëŒ€ì¤‘ë¬¸í™”",
                ["K-POP", "ì•„ì´ëŒ/ì—°ì˜ˆì¸", "ìœ íŠœë¸Œ/ìŠ¤íŠ¸ë¦¬ë°", "ì›¹íˆ°/ì›¹ì†Œì„¤", "ìŠ¤í¬ì¸  ìŠ¤íƒ€"]
            )

            # --- ì¶”êµ¬í•˜ëŠ” ì„±í–¥ ---
            st.subheader("â— 5) íŠ¹ë³„í•œ ì·¨í–¥/ì„±í–¥")
            
            new_vs_stable = st.radio(
                "ìƒˆë¡œìš´ ê²½í—˜ê³¼ ì•ˆì •ê° ì¤‘ ì–´ëŠ ê²ƒì„ ë” ì„ í˜¸í•˜ì‹œë‚˜ìš”?",
                ["ìƒˆë¡œìš´ ê²½í—˜ì„ ì¶”êµ¬í•©ë‹ˆë‹¤", "ì•ˆì •ì ì´ê³  ìµìˆ™í•œ ê²ƒì„ ì„ í˜¸í•©ë‹ˆë‹¤"]
            )
            
            preference = st.multiselect(
                "ë³¸ì¸ì—ê²Œ í•´ë‹¹í•˜ëŠ” ì„±í–¥ì„ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.",
                ["í˜¼ì ë³´ë‚´ëŠ” ì‹œê°„ ì„ í˜¸", "ì¹œêµ¬ë“¤ê³¼ ì–´ìš¸ë¦¬ê¸° ì„ í˜¸", "ì‹¤ë‚´ í™œë™ ì„ í˜¸", "ì•¼ì™¸ í™œë™ ì„ í˜¸"]
            )

            survey_submitted = st.form_submit_button("ì„¤ë¬¸ ì™„ë£Œí•˜ê³  ë§¤ì¹­ ì‹œì‘í•˜ê¸°")
            if survey_submitted:
                st.balloons()
                st.success("ğŸ‰ ë©˜í†  í”„ë¡œí•„ ì„¤ë¬¸ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ì´ì œ ë©˜í‹°ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
                set_page('find_matches')
        
        st.markdown("---")
        st.info("âœ… ëª¨ë“  ì„¤ë¬¸ í•­ëª©ì„ ì‘ì„±í•˜ê³  **'ì„¤ë¬¸ ì™„ë£Œí•˜ê³  ë§¤ì¹­ ì‹œì‘í•˜ê¸°'** ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.")

elif st.session_state.page == 'find_matches':
    st.title("ğŸ” ë©˜í‹° ì°¾ê¸°")
    st.write("ë©˜í† ë‹˜ì—ê²Œ ì í•©í•œ ë©˜í‹°ë“¤ì„ ì¶”ì²œí•©ë‹ˆë‹¤.")
    st.info("âœ… í˜„ì¬ ë§¤ì¹­ ê°€ëŠ¥í•œ ë©˜í‹°ê°€ ì—†ìŠµë‹ˆë‹¤. ê³§ ìƒˆë¡œìš´ ë©˜í‹°ê°€ ê°€ì…ë  ì˜ˆì •ì…ë‹ˆë‹¤.") 

elif st.session_state.page == 'my_matches':
    st.title("ğŸ‘¤ ë‚´ ë§¤ì¹­")
    st.write("í˜„ì¬ ë§¤ì¹­ëœ ë©˜í‹°ì™€ì˜ ì†Œí†µ ê³µê°„ì…ë‹ˆë‹¤.")
    st.info("âœ… ì•„ì§ ë§¤ì¹­ëœ ìƒëŒ€ê°€ ì—†ìŠµë‹ˆë‹¤. 'ë©˜í‹° ì°¾ê¸°'ë¥¼ í†µí•´ ìƒëŒ€ë¥¼ ì°¾ì•„ë³´ì„¸ìš”.")

elif st.session_state.page == 'admin_dashboard':
    st.title("âš™ï¸ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ")
    st.write("í”Œë«í¼ ì „ì²´ íšŒì› í˜„í™© ë° ë§¤ì¹­ í˜„í™©ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.")
    st.warning("âœ… ì´ í˜ì´ì§€ëŠ” ê´€ë¦¬ìë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
